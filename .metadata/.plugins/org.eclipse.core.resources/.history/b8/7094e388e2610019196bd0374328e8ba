package gofmpro;

import java.io.IOException;

import org.testng.ITestResult;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.AfterTest;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;

import com.relevantcodes.extentreports.ExtentReports;
import com.relevantcodes.extentreports.ExtentTest;
import com.relevantcodes.extentreports.LogStatus;

import Com.TestBase.TestBase;
import Pages.Createcompany;
import Pages.GOFT27;
import Pages.GOFT28;
import Pages.Login;
import TestUtil.TestUtil;

public class GOFT27Test extends TestBase{
	Login login;
	Createcompany createcompany;
	GOFT27 gOFT27;
	GOFT28 gOFT28;

	
	ExtentReports extent;
	ExtentTest  logger;

	public GOFT27Test(){
		super();
		
	}
	@BeforeMethod
	public void setUp() throws InterruptedException{
		initialization();
	
		login = new Login();
		createcompany = new Createcompany();
		gOFT27 = new GOFT27();
		gOFT28 = new GOFT28();
		

		extent = new ExtentReports("/home/zentere/workspace/gofmpro/ErrorScreenshot/ExtentReport.html");
		 logger  = extent.startTest("loginPage");


	}
	@Test(priority=1)
	public void loginTest() throws InterruptedException{

		//Test1
			createcompany = login.login(prop.getProperty("Email"), prop.getProperty("Password"));
			
			logger.log(LogStatus.PASS, "Login Page Pass");
			String screenshotpath = TestUtil.captureScreenshot(driver,"login");
			logger.log(LogStatus.PASS, logger.addScreenCapture(screenshotpath));
			logger.log(LogStatus.INFO, "successfully Login ");
			logger.log(LogStatus.INFO, "Login Completed");
		
			
				//Test2
				ExtentTest test2 = extent.startTest("CreateCompany");
			   gOFT27 =createcompany.CreateCompany(prop.getProperty("CompanyName"),prop.getProperty("Code"));
			   test2.log(LogStatus.PASS, "create company Pass");
			   String screenshotpath1 = TestUtil.captureScreenshot(driver,"CreateCompany");
			   test2.log(LogStatus.PASS, logger.addScreenCapture(screenshotpath1));
			   
			   test2.log(LogStatus.INFO, "successfully CreateCompany ");
				
				//Test3

			   	ExtentTest  test3= extent.startTest("CreateUser");

					gOFT28 =gOFT27.CreateUser(prop.getProperty("EnterName"), prop.getProperty("EnterEmail"));
					test3.log(LogStatus.PASS, "create User Pass");
					   String screenshotpath2 = TestUtil.captureScreenshot(driver,"CreateUser");
					   test3.log(LogStatus.PASS, logger.addScreenCapture(screenshotpath2));
					   test3.log(LogStatus.INFO, "successfully create user ");
				
	}
	
	/*@Test(priority=2)
	public void CreateCompanyTest() throws InterruptedException{
		

		//Test2
	   logger = extent.startTest("CreateCompany");
		logger.log(LogStatus.PASS, "CreateCompany Page Pass");
	   gOFT27 =gOFT26.CreateCompany(prop.getProperty("CompanyName"),prop.getProperty("Code"));
		logger.log(LogStatus.INFO, "successfully CreateCompany ");

		
	}
	@Test(priority=3)
	public void CreateUserTest() throws InterruptedException{
		   logger = extent.startTest("CreateUser");
			logger.log(LogStatus.PASS, "CreateUser Page Pass");
			gOFT28 =gOFT27.CreateUser(prop.getProperty("EnterName"), prop.getProperty("EnterEmail"));
			logger.log(LogStatus.INFO, "successfully CreateUser ");

	}*/

	@AfterMethod
	public void tearDown(ITestResult result) throws IOException{
		if(result.getStatus()== ITestResult.FAILURE)
			
			
		{
			String screenshotpath = TestUtil.captureScreenshot(driver,"CreateCompany");

			//logger.log(LogStatus.FAIL, result.getName());
			logger.log(LogStatus.FAIL, result.getThrowable());
			//String screenshotpath = TestUtil.captureScreenshot(driver, result.getName());
			logger.log(LogStatus.FAIL, logger.addScreenCapture(screenshotpath));
			logger.log(LogStatus.INFO, "Same company code entered");

			
		}
		extent.endTest(logger);
	}

	@AfterTest
	public void endTest() {
		extent.flush();
		extent.close();
		driver.close();
	}
	}

